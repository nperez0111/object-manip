{"version":3,"sources":["../../src/lib/transforms.js"],"names":[],"mappings":"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","file":"transforms.js","sourcesContent":["import {\n    reducer,\n    createObj,\n    makeObj,\n    levelOfTransform,\n    traverse,\n    valueOf\n} from './utils';\n\nimport {\n    actualCopy,\n    parseRelocator\n} from './logic';\n\nimport {\n    isString,\n    curry,\n    isFunc,\n    isArray,\n    hasOwnProp,\n    isStringOrArr,\n    isObj,\n    props\n} from './deps';\nconst toStr = str => isArray( str ) ? str[ 0 ] : str;\nlet hasDeepTransform = ( transformer, isDeep = true ) => {\n\n        let { keys, values } = props( transformer )\n\n\n\n        return values.some( function ( cur ) {\n\n            if ( isStringOrArr( cur ) ) {\n\n                return levelOfTransform( toStr( cur ) ) > 1;\n\n            } else if ( isDeep && isObj( cur ) ) {\n\n                return hasDeepTransform( cur );\n\n            } else {\n                //i guess no other case is it relevant\n                return false;\n            }\n\n        } );\n    },\n    postTransform = ( transformer ) => {\n\n        return ( traverse( transformer, ( value, i, key ) => {\n\n            let val = null;\n\n            if ( isStringOrArr( value ) ) {\n\n                let str = toStr( value );\n                val = str.slice( levelOfTransform( str ) * 2 );\n\n                if ( isArray( value ) ) {\n                    val = [ val, value[ 1 ] ];\n                }\n\n            } else {\n\n                val = postTransform( value );\n\n            }\n\n            return createObj( key, val );\n\n        }, true ) );\n    },\n    findDeepNonTransforms = ( transformer ) => {\n\n        let passesTest = value => {\n\n            if ( !isObj( value ) ) {\n\n                if ( isStringOrArr( value ) ) {\n                    return levelOfTransform( toStr( value ) ) < 2;\n\n                }\n\n                return true;\n\n            }\n\n            return findDeepNonTransforms( value ).length !== 0;\n\n        };\n        return traverse( transformer, function ( value, i, key ) {\n            if ( passesTest( value ) ) {\n\n                if ( !isObj( value ) ) {\n\n                    return createObj( key, value );\n\n                }\n\n                //look inside the val for non transforms\n                return createObj( key, reducer( findDeepNonTransforms( value ) ) );\n            }\n            return false;\n        } ).filter( a => a !== false );\n\n    },\n    findDeepTransforms = ( transformer, notTransforms = true ) => {\n\n        return traverse( transformer, ( cur, i, value ) => {\n            //[boolean checking if immediate values in the object have deeptransforms needed, index]\n            return hasDeepTransform( createObj( cur, value ), true ) === notTransforms ? [ cur, value ] : false;\n\n        }, false, true ).filter( a => a ).map( cur => {\n            let [ key, val ] = cur\n\n            if ( isObj( val ) ) {\n\n                val = reducer( findDeepTransforms( val ) );\n\n            }\n\n            return createObj( key, val );\n\n        } );\n\n    },\n    deepTraversal = ( original ) => {\n\n        return ( traverse( original, function ( value, i, key ) {\n\n            let val = null;\n\n            if ( isStringOrArr( value ) ) {\n\n                let str = toStr( value ),\n                    num = levelOfTransform( str );\n                val = [ ( str.slice( num * 2 ) ), num ];\n\n            } else {\n\n                val = deepTraversal( value )[ 0 ];\n                val[ 0 ] = `${key},${val[ 0 ]}`;\n\n            }\n\n            return val;\n\n        } ) );\n\n    };\n\nexport {\n    deepTraversal,\n    findDeepTransforms,\n    findDeepNonTransforms,\n    postTransform,\n    hasDeepTransform\n};\n"]}