{"version":3,"sources":["../src/index.js"],"names":[],"mappings":";;AAAA;;AASA;;AAOA;;AAMA;;AAUA;;AAQA,IAAI,mBAAmB,KAAvB;AAAA,IACI,OAAO,KADX;;AAMA,IAAI,OAAO,iBAAO,UAAW,WAAX,EAAwB,GAAxB,EAA8B;AACxC,QAAK,6CAA8B,WAA9B,KAA+C,sCAAuB,GAAvB,CAApD,EAAmF;AAC/E,YAAK,kCAAkB,WAAlB,CAAL,EAAuC;AACnC,mBAAO,cAAe,oDAAqC,GAArC,EAA0C,WAA1C,CAAf,EAAwE,GAAxE,CAAP;AACH,SAFD,MAEO;AACH,mBAAO,UAAW,oDAAqC,GAArC,EAA0C,WAA1C,CAAX,EAAoE,GAApE,CAAP;AACH;AACJ;AACD,WAAO,EAAP;AACH,CATM,CAAX;AAAA,IAUI,gBAAgB,SAAhB,aAAgB,CAAW,WAAX,EAAwB,GAAxB,EAA8B;AAC1C,QAAI,WAAW,OAAO,OAAP,CAAe,QAA9B;;AAEA,QAAK,SAAS,OAAd,EAAwB;AACpB,YAAI,OAAO,GAAX;AACA,cAAM,WAAN;AACA,sBAAc,IAAd;AACA,eAAO,IAAP;AACH;;AAED,QAAI,aAAe,oBAAS,oCAAoB,WAApB,CAAT,CAAnB;AACA,QAAI,MAAM,UAAa,oBAAS,uCAAuB,WAAvB,CAAT,CAAb,EAAgE,GAAhE,CAAV;;AAEA,QAAI,cAAc,UAAW,+BAAe,UAAf,CAAX,EAAwC,GAAxC,CAAlB;AACA,QAAI,YAAc,+BAAe,UAAf,CAAlB;AACA;;AAEA,QAAI,mBAAmB,uBAAY,SAAZ,EAAuB,WAAvB,CAAvB;AACA;;;AAGA,WAAO,OAAO,MAAP,CAAe,GAAf,EAAoB,gBAApB,CAAP;AAGH,CAlCL;AAAA,IAmCI,YAAY,iBAAO,UAAW,WAAX,EAAwB,GAAxB,EAA8B;;AAE7C,QAAI,WAAW,OAAO,OAAP,CAAe,QAA9B;;AAEA,QAAK,SAAS,OAAd,EAAwB;AACpB,YAAI,OAAO,GAAX;AACA,cAAM,WAAN;AACA,sBAAc,IAAd;AACA,eAAO,IAAP;AACH;;AAED,QAAI,MAAM,cAAe,WAAf,EAA4B,GAA5B,EAAiC,QAAjC,CAAV;AACA,QAAK,mBAAS,GAAT,CAAL,EAAsB;AAClB,eAAO,IAAK,CAAL,EAAU,CAAV,EAAe,CAAf,CAAP;AACH;AACD,WAAO,GAAP;AAEH,CAjBW,CAnChB;AAAA,IAqDI,WAAW,SAAX,QAAW,CAAW,IAAX,EAAiB,IAAjB,EAAuB,GAAvB,EAA6B;;AAEpC,QAAK,yBAAe,IAAf,CAAL,EAA6B;;AAEzB,eAAO,IAAP;;AAEA,eAAO,IAAK,IAAL,CAAP;AAEH,KAND,MAMO,IAAK,kBAAQ,IAAR,CAAL,EAAsB;;AAEzB,YAAK,sBAAY,GAAZ,EAAiB,IAAjB,CAAL,EAA+B;;AAE3B,mBAAO,oBAAS,IAAK,IAAL,CAAT,EAAsB,IAAtB,EAA4B,OAAO,OAAP,CAAe,QAAf,CAAwB,OAApD,CAAP;AAEH,SAJD,MAIO;AACH;AACA,mBAAO,IAAP;AAEH;AAEJ,KAZM,MAYA,IAAK,iBAAO,IAAP,KAAiB,iBAAO,GAAP,CAAtB,EAAqC;;AAExC,YAAI,mBAAqB,cAAe,IAAf,EAAqB,IAAK,IAAL,CAArB,EAAkC,QAAlC,CAAzB;AACA,YAAK,mBAAS,gBAAT,CAAL,EAAmC;AAC/B;AACA,+BAAmB,iBAAkB,CAAlB,EAAsB,GAAtB,CAA2B,UAAW,QAAX,EAAsB;AAChE,uBAAO,SAAU,CAAV,CAAP;AACH,aAFkB,CAAnB;;AAIA,+BAAmB,iBAAkB,CAAlB,CAAnB;AACH;AACD,eAAO,gBAAP;AAEH;;AAED;AACA,WAAO,IAAP;AAEH,CA3FL;AAAA,IA4FI,gBAAgB,SAAhB,aAAgB,CAAW,GAAX,EAAgB,MAAhB,EAAwB,QAAxB,EAAmC;AAC/C,QAAI,OAAO,OAAO,IAAP,CAAa,GAAb,CAAX;AAAA,QACI,QAAQ,EADZ;AAAA,QAEI,UAAU,EAFd;AAAA,QAGI,MAAM,EAHV;AAAA,QAII,SAAS,KAAK,GAAL,CAAU,UAAW,GAAX,EAAgB,CAAhB,EAAoB;;AAEnC,YAAM,MAAM,SAAU,IAAK,GAAL,CAAV,EAAsB,GAAtB,EAA2B,MAA3B,CAAZ;;AAEA,YAAK,SAAS,KAAd,EAAsB;AAClB,kBAAM,IAAN,CAAY,CAAE,IAAF,EAAQ,CAAR,CAAZ;AACA,mBAAO,KAAP;AACH;AACD,YAAK,qBAAqB,KAA1B,EAAkC;AAC9B,oBAAQ,IAAR,CAAc,gBAAd;AACA,+BAAmB,KAAnB;AACH;AACD,eAAO,GAAP;AACH,KAbQ,CAJb;AAAA,QAkBI,MAAM,EAlBV;;AAoBA,QAAK,MAAM,MAAX,EAAoB;;AAEhB,cAAM,OAAN,CAAe,UAAW,GAAX,EAAiB;AAC5B,gBAAI,MAAM,IAAK,CAAL,CAAV;AAAA,gBACI,OAAO,KADX;AAEA,gBAAK,mBAAS,IAAK,CAAL,CAAT,CAAL,EAA2B;AACvB,sBAAM,IAAK,CAAL,EAAU,CAAV,CAAN;AACA,uBAAO,IAAK,CAAL,EAAU,CAAV,CAAP;AACH;AACD;;AAEA,gBAAI,YAAY,2BAAgB,GAAhB,EAAqB,IAAK,CAAL,CAArB,EAA+B,IAA/B,EAAqC,MAArC,EAA6C,IAA7C,EAAmD,OAAO,OAAP,CAAe,QAAf,CAAwB,OAA3E,CAAhB;AACA,mBAAO,UAAW,CAAX,CAAP;AACA,qBAAS,UAAW,CAAX,CAAT;;AAEA,gBAAK,UAAU,MAAV,IAAoB,CAAzB,EAA6B;;AAEzB,oBAAI,IAAJ,CAAY,UAAW,CAAX,CAAZ;AAEH;AACJ,SAlBD;AAoBH;;AAED,QAAK,QAAQ,MAAb,EAAsB;;AAElB,gBAAQ,OAAR,CAAiB,UAAW,GAAX,EAAiB;;AAE9B,gBAAI,OAAJ,CAAa,UAAW,IAAX,EAAkB;;AAE3B,uBAAO,KAAK,MAAL,CAAa,OAAO,IAAP,CAAa,IAAb,CAAb,CAAP;;AAEA,yBAAS,OAAO,MAAP,CAAe,OAAO,IAAP,CAAa,IAAb,EAAoB,GAApB,CAAyB,UAAW,CAAX,EAAe;AAC5D,2BAAO,KAAM,CAAN,CAAP;AACH,iBAFuB,CAAf,CAAT;AAIH,aARD;AAUH,SAZD;AAcH;;AAED,SAAK,OAAL,CAAc,UAAW,GAAX,EAAgB,CAAhB,EAAoB;AAC9B,YAAK,iBAAO,OAAQ,CAAR,CAAP,CAAL,EAA4B;AACxB,gBAAK,OAAO,IAAP,CAAa,OAAQ,CAAR,CAAb,EAA2B,MAA3B,IAAqC,CAA1C,EAA8C;AAC1C;AACH;AACJ;AACD,YAAK,GAAL,IAAa,OAAQ,CAAR,CAAb;AACH,KAPD;;AASA,QAAK,IAAI,MAAT,EAAkB;AACd,cAAM,CAAE,GAAF,EAAO,GAAP,CAAN;AACH;;AAED,WAAO,GAAP;AACH,CAzKL;;AA2KA,IAAI,IAAI;AACJ,kDADI;AAEJ,sDAFI;AAGJ,gCAHI;AAIJ,wBAJI;AAKJ,cALI;AAMJ,SAAK;AACD,cAAM;AADL,KAND;AASJ,mBAAe,yBAAY;AACvB,eAAO,OAAP,CAAe,QAAf,CAAwB,OAAxB,GAAkC,CAAC,OAAO,OAAP,CAAe,QAAf,CAAwB,OAA3D;AACA,eAAO,OAAO,OAAP,CAAe,QAAf,CAAwB,OAA/B;AACH,KAZG;AAaJ,aAAS,iBAAW,OAAX,EAAqB;AAC1B,eAAO,OAAP,CAAe,QAAf,CAAwB,OAAxB,GAAkC,OAAlC;AACA,eAAO,IAAP;AACH,KAhBG;AAiBJ,cAAU;AACN,iBAAS,KADH;AAEN,iBAAS;AAFH;AAjBN,CAAR;;AAuBA,OAAO,OAAP,GAAiB,IAAjB;AACA,OAAO,IAAP,CAAa,CAAb,EAAiB,OAAjB,CAA0B,aAAK;AAC3B,WAAO,OAAP,CAAgB,CAAhB,IAAsB,EAAG,CAAH,CAAtB;AACH,CAFD;;AAIA,OAAO,OAAP,CAAe,SAAf,CAAyB,IAAzB,GAAgC,IAAhC;;AAEA,SAAS,GAAT,CAAc,CAAd,EAAkB;AACd,YAAQ,GAAR,CAAa,CAAb;AACA,WAAO,CAAP;AACH;AACD,IAAI,KAAK,iBAAO,UAAW,CAAX,EAAc,CAAd,EAAkB;AAC9B,QAAK,CAAL;AACA,QAAK,CAAL;AACA,QAAK,SAAS,CAAd;AACA,WAAO,CAAP;AACH,CALQ,CAAT","file":"index.js","sourcesContent":["import {\n    reducer,\n    createObj,\n    makeObj,\n    levelOfTransform,\n    traverse,\n    valueOf\n} from './lib/utils';\n\nimport {\n    onlyPropertiesThatCorrespondBetween,\n    dataIsInCorrectFormat,\n    transformerIsInCorrectFormat,\n    transformerTypesInCorrect\n} from './lib/typeCheck';\n\nimport {\n    actualCopy,\n    parseRelocator\n} from './lib/logic';\n\n\nimport {\n    isString,\n    curry,\n    isFunc,\n    isArray,\n    hasOwnProp,\n    isStringOrArr,\n    isObj\n} from './lib/deps';\n\nimport {\n    deepTraversal,\n    findDeepTransforms,\n    findDeepNonTransforms,\n    postTransform,\n    hasDeepTransform\n} from './lib/transforms';\n\nlet needsToBeSetBack = false,\n    flag = false;\n\n\n\n\nlet deep = curry( function ( transformer, obj ) {\n        if ( transformerIsInCorrectFormat( transformer ) && dataIsInCorrectFormat( obj ) ) {\n            if ( hasDeepTransform( transformer ) ) {\n                return deepTransform( onlyPropertiesThatCorrespondBetween( obj, transformer ), obj );\n            } else {\n                return transform( onlyPropertiesThatCorrespondBetween( obj, transformer ), obj );\n            }\n        }\n        return {};\n    } ),\n    deepTransform = function ( transformer, obj ) {\n        let settings = module.exports.settings;\n\n        if ( settings.reverse ) {\n            let temp = obj;\n            obj = transformer;\n            transformer = temp;\n            temp = null;\n        }\n\n        let workNeeded = ( reducer( findDeepTransforms( transformer ) ) );\n        let yay = transform( ( reducer( findDeepNonTransforms( transformer ) ) ), obj );\n\n        let transformed = transform( postTransform( workNeeded ), obj );\n        let keysToVal = ( deepTraversal( workNeeded ) );\n        /*lo( 'keysToVal', keysToVal )\n        lo( 'transformed', transformed )*/\n        let finallyMovedBack = actualCopy( keysToVal, transformed );\n        /*log( 'eas' );\n        log( workNeeded );*/\n\n        return Object.assign( yay, finallyMovedBack );\n\n\n    },\n    transform = curry( function ( transformer, obj ) {\n\n        let settings = module.exports.settings;\n\n        if ( settings.reverse ) {\n            let temp = obj;\n            obj = transformer;\n            transformer = temp;\n            temp = null;\n        }\n\n        let ret = replaceValues( transformer, obj, callback );\n        if ( isArray( ret ) ) {\n            return ret[ 1 ][ 0 ][ 0 ];\n        }\n        return ret;\n\n    } ),\n    callback = function ( func, prop, obj ) {\n\n        if ( isStringOrArr( func ) ) {\n\n            flag = func;\n\n            return obj[ prop ];\n\n        } else if ( isFunc( func ) ) {\n\n            if ( hasOwnProp( obj, prop ) ) {\n\n                return valueOf( obj[ prop ], func, module.exports.settings.thisArg );\n\n            } else {\n                //figure out a way to remove the obj key so we dont have a loose function lying around\n                return func;\n\n            }\n\n        } else if ( isObj( func ) && isObj( obj ) ) {\n\n            let objPostTransform = ( replaceValues( func, obj[ prop ], callback ) );\n            if ( isArray( objPostTransform ) ) {\n                //is in format[object itself, objects to be sent up a level]\n                needsToBeSetBack = objPostTransform[ 1 ].map( function ( wentBack ) {\n                    return wentBack[ 0 ];\n                } );\n\n                objPostTransform = objPostTransform[ 0 ];\n            }\n            return objPostTransform;\n\n        }\n\n        //should just overwrite the value if is not a string, function, or object\n        return func;\n\n    },\n    replaceValues = function ( obj, actual, callback ) {\n        let keys = Object.keys( obj ),\n            edits = [],\n            setBack = [],\n            add = [],\n            values = keys.map( function ( key, i ) {\n\n                const val = callback( obj[ key ], key, actual );\n\n                if ( flag !== false ) {\n                    edits.push( [ flag, i ] );\n                    flag = false;\n                }\n                if ( needsToBeSetBack !== false ) {\n                    setBack.push( needsToBeSetBack );\n                    needsToBeSetBack = false;\n                }\n                return val;\n            } ),\n            ret = {};\n\n        if ( edits.length ) {\n\n            edits.forEach( function ( cur ) {\n                let str = cur[ 0 ],\n                    func = false;\n                if ( isArray( cur[ 0 ] ) ) {\n                    str = cur[ 0 ][ 0 ];\n                    func = cur[ 0 ][ 1 ];\n                }\n                //log( 'preparse' )\n\n                let postParse = parseRelocator( str, cur[ 1 ], keys, values, func, module.exports.settings.thisArg );\n                keys = postParse[ 0 ];\n                values = postParse[ 1 ];\n\n                if ( postParse.length == 3 ) {\n\n                    add.push( ( postParse[ 2 ] ) );\n\n                }\n            } );\n\n        }\n\n        if ( setBack.length ) {\n\n            setBack.forEach( function ( cur ) {\n\n                cur.forEach( function ( objy ) {\n\n                    keys = keys.concat( Object.keys( objy ) );\n\n                    values = values.concat( Object.keys( objy ).map( function ( a ) {\n                        return objy[ a ];\n                    } ) );\n\n                } );\n\n            } );\n\n        }\n\n        keys.forEach( function ( cur, i ) {\n            if ( isObj( values[ i ] ) ) {\n                if ( Object.keys( values[ i ] ).length == 0 ) {\n                    return;\n                }\n            }\n            ret[ cur ] = values[ i ];\n        } );\n\n        if ( add.length ) {\n            ret = [ ret, add ];\n        }\n\n        return ret;\n    };\n\nlet d = {\n    hasDeepTransform,\n    findDeepTransforms,\n    deepTransform,\n    transform,\n    deep,\n    not: {\n        deep: transform\n    },\n    toggleReverse: function () {\n        module.exports.settings.reverse = !module.exports.settings.reverse;\n        return module.exports.settings.reverse;\n    },\n    setThis: function ( newThis ) {\n        module.exports.settings.thisArg = newThis;\n        return true;\n    },\n    settings: {\n        reverse: false,\n        thisArg: null\n    }\n}\n\nmodule.exports = deep;\nObject.keys( d ).forEach( a => {\n    module.exports[ a ] = d[ a ];\n} );\n\nmodule.exports.transform.deep = deep;\n\nfunction log( a ) {\n    console.log( a );\n    return a;\n}\nlet lo = curry( function ( a, b ) {\n    log( a );\n    log( b );\n    log( 'end ' + a );\n    return b;\n} );\n"]}